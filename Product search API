# Python code using Flask for API implementation

from flask import Flask, request, jsonify
from pymongo import MongoClient

app = Flask(__name__)
client = MongoClient("mongodb+srv://username:password@cluster.mongodb.net/dbname?retryWrites=true&w=majority")

db = client["fashion_app_database"]
catalog = db["catalog"]

@app.route('/product_search', methods=['GET'])
def product_search():
    keyword = request.args.get('search_keyword')
    price_min = float(request.args.get('price_min', 0))
    price_max = float(request.args.get('price_max', float('inf')))

    # Implement search logic and price range filter here

    # Return top 10 products based on rank
    result = catalog.find().sort("rank").limit(10)
    response = [{"product_id": item["product_id"],
                 "product_category": item["product_category"],
                 "Rank": item["Rank"],
                 "brand_name": item["brand_name"],
                 "product_description": item["product_description"],
                 "price": item["price"],
                 "image_link": item["image_link"]} for item in result]

    return jsonify(response)

if __name__ == '__main__':
    app.run(debug=True)
